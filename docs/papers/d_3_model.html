<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.21">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="gitSAM">

<title>AI시대 동역학 모형 – GitSAM</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-b2bd955b7378b94aa8c2ba4fafa553c9.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-bb5f9278568ae542f8467bdb635b70ac.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar floating nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title"><a href="../index.html">GitSAM</a></span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-papers" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Papers</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-papers">    
        <li>
    <a class="dropdown-item" href="./index.html">
 <span class="dropdown-text">Working</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./../paper-tbtf/index.qmd">
 <span class="dropdown-text">TBTF</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-books" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Books</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-books">    
        <li>
    <a class="dropdown-item" href="./../book-gitsam-stats/index.qmd">
 <span class="dropdown-text">gitsam 기초통계학</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://primenumbersam.github.io/">
 <span class="dropdown-text">AI 응용 선형대수학</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="https://github.com/primenumbersam/"> 
<span class="menu-text">Apps</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://www.gitsam.com"> 
<span class="menu-text">스터디클럽</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools tools-wide">
    <a href="https://laroe.co.kr/" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-shop"></i></a>
    <a href="https://www.youtube.com/@primenumbersam" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-youtube"></i></a>
    <div class="dropdown">
      <a href="" title="" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label=""><i class="bi bi-github"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://github.com/primenumbersam/primenumbersam.github.io">
            Source Code
            </a>
          </li>
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="mailto:primenumbersam@gmail.com">
            Report a Bug
            </a>
          </li>
      </ul>
    </div>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./d_overview.html">돈의 동역학</a></li><li class="breadcrumb-item"><a href="./d_3_model.html">AI시대 동역학 모형</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">GitSAM 교육+연구</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">경제</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./gitsam_reading.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">gitsam 독후감</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./indicator_growth.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">경제성장 대표지표?</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./labor_decoupling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">노동: 기여 vs.&nbsp;분배</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./regressions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">From Linear to Curved Structures to Fit the Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pareto_index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Modeling Wealth Distribution</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./gilded_age.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">New Gilded Age</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./modern_matthew.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Modern Matthew Effect</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dichotomy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Identifying Dichotomy</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pricing_equal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Market Price of Education</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./corner_solution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Corner Solutions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./market_conditions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Free Market Conditions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./market_incomplete.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Incomplete Markets</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./structure_cointegration.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Time-Varying Cointegration</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./structure_tfp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Time-varying TFP</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">금융</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./yield_curve.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Yield curve</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./correlation_crypto.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Correlation in Cryptos</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./finance_asset_puzzle.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Asset Premium Puzzles</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./finance_linear.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Linear Models of Finance</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./finance_existence.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Rethinking Asset Existence</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./capm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Revisiting the CAPM</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./capm_industry.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Industry CAPM</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">돈의 동역학</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./d_overview.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">AI시대 자본과 노동</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./d_1_critique.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">주류경제학 비판</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./d_2_elementary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">동역학 기초수학</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./d_3_model.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">AI시대 동역학 모형</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./d_4_ethics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">AI시대 경제윤리</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#parameters" id="toc-parameters" class="nav-link active" data-scroll-target="#parameters">Parameters</a></li>
  <li><a href="#asymptotic-scenarios" id="toc-asymptotic-scenarios" class="nav-link" data-scroll-target="#asymptotic-scenarios">Asymptotic Scenarios</a></li>
  <li><a href="#structural-irreversibility-and-phase-space-mutation" id="toc-structural-irreversibility-and-phase-space-mutation" class="nav-link" data-scroll-target="#structural-irreversibility-and-phase-space-mutation">Structural Irreversibility and Phase Space Mutation</a></li>
  <li><a href="#estimating-parameters-with-level-data" id="toc-estimating-parameters-with-level-data" class="nav-link" data-scroll-target="#estimating-parameters-with-level-data">Estimating Parameters with Level Data</a></li>
  <li><a href="#estimating-parameters-with-share-data" id="toc-estimating-parameters-with-share-data" class="nav-link" data-scroll-target="#estimating-parameters-with-share-data">Estimating Parameters with Share Data</a>
  <ul class="collapse">
  <li><a href="#u.s.-wealth-share-data-19892024-quarterly" id="toc-u.s.-wealth-share-data-19892024-quarterly" class="nav-link" data-scroll-target="#u.s.-wealth-share-data-19892024-quarterly">U.S. Wealth Share Data (1989–2024, Quarterly)</a></li>
  <li><a href="#share-based-dynamics" id="toc-share-based-dynamics" class="nav-link" data-scroll-target="#share-based-dynamics">Share-Based Dynamics</a></li>
  <li><a href="#empirical-findings" id="toc-empirical-findings" class="nav-link" data-scroll-target="#empirical-findings">Empirical Findings</a></li>
  </ul></li>
  <li><a href="#plots" id="toc-plots" class="nav-link" data-scroll-target="#plots">Plots</a>
  <ul class="collapse">
  <li><a href="#us-wealth-share-data" id="toc-us-wealth-share-data" class="nav-link" data-scroll-target="#us-wealth-share-data">US Wealth Share Data</a></li>
  <li><a href="#time-varying-parameter-estimates-all-groups" id="toc-time-varying-parameter-estimates-all-groups" class="nav-link" data-scroll-target="#time-varying-parameter-estimates-all-groups">Time-Varying Parameter Estimates (All Groups)</a></li>
  <li><a href="#distribution-of-estimated-parameters-histogram" id="toc-distribution-of-estimated-parameters-histogram" class="nav-link" data-scroll-target="#distribution-of-estimated-parameters-histogram">Distribution of Estimated Parameters (Histogram)</a></li>
  </ul></li>
  <li><a href="#parameter-summary-table-group-wise-statistics-by-parameter" id="toc-parameter-summary-table-group-wise-statistics-by-parameter" class="nav-link" data-scroll-target="#parameter-summary-table-group-wise-statistics-by-parameter">Parameter Summary Table: Group-Wise Statistics by Parameter</a></li>
  <li><a href="#simulated-system-dynamics-with-calibrated-labor-driven-capital-growth-a_21-0.0007" id="toc-simulated-system-dynamics-with-calibrated-labor-driven-capital-growth-a_21-0.0007" class="nav-link" data-scroll-target="#simulated-system-dynamics-with-calibrated-labor-driven-capital-growth-a_21-0.0007">Simulated System Dynamics with Calibrated Labor-Driven Capital Growth (<span class="math inline">\(a_{21} = 0.0007\)</span>)</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./d_overview.html">돈의 동역학</a></li><li class="breadcrumb-item"><a href="./d_3_model.html">AI시대 동역학 모형</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">AI시대 동역학 모형</h1>
<p class="subtitle lead">Structural Mutation Model via Automation</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>gitSAM </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<blockquote class="blockquote">
<p>From Closed to Open</p>
</blockquote>
<p>In closed systems, labor and capital exist in mutual interaction. Labor produces output, capital accumulates via labor input, and the feedback between them sustains the economy’s dynamical structure. Such systems can cycle, stabilize, or collapse—but they do so <strong>within</strong> a conservative phase space.</p>
<p>However, <strong>automation</strong> introduces a structural mutation. It does not simply accelerate capital accumulation; it changes the topology of the system itself. Capital becomes self-replicating—<strong>decoupled</strong> from labor. The result is a qualitative shift: the system becomes <strong>open</strong>, <strong>non-conservative</strong>, and potentially <strong>labor-exclusionary</strong>.</p>
<p>We formalize this mutation using a modified Lotka–Volterra interaction system between labor <span class="math inline">\(L(t)\)</span> and capital <span class="math inline">\(C(t)\)</span>:</p>
<p><span class="math display">\[
\frac{dL}{dt} = a_{1,1} L - a_{1,2} L C,
\]</span></p>
<p><span class="math display">\[
\frac{dC}{dt} = a_{2,1} L C + a_{2,2} C - a_{2,3} C - a_{2,4} C^2.
\]</span></p>
<section id="parameters" class="level2">
<h2 class="anchored" data-anchor-id="parameters">Parameters</h2>
<p>Each parameter governs a fundamental mechanism:</p>
<ul>
<li><span class="math inline">\(a_{1,1}\)</span>: autonomous growth of labor—birth, training, or onboarding.</li>
<li><span class="math inline">\(a_{1,2}\)</span>: capital-induced labor dissipation—outsourcing, automation, or deskilling.</li>
<li><span class="math inline">\(a_{2,1}\)</span>: labor-driven capital accumulation—human-centered production.</li>
<li><span class="math inline">\(a_{2,2}\)</span>: capital self-replication—automation, platform scaling, AI compounding.</li>
<li><span class="math inline">\(a_{2,3}\)</span>: depreciation—maintenance, obsolescence, or asset decay.</li>
<li><span class="math inline">\(a_{2,4}\)</span>: <strong>nonlinear dissipation within capital</strong>—interpreted not merely as diminishing returns, but as <strong>elite–elite rivalry</strong>, strategic cannibalism, and systemic congestion at the top.</li>
</ul>
<p>The first equation describes labor’s fate: a positive growth term (<span class="math inline">\(a_{1,1} L\)</span>) is offset by an absorption term (<span class="math inline">\(-a_{1,2} L C\)</span>), which accelerates as capital increases. This structure encodes labor’s vulnerability to capital dominance: if capital grows faster than labor, labor becomes increasingly exposed to structural replacement.</p>
<p>The second equation governs capital: it can grow through labor (<span class="math inline">\(a_{2,1} LC\)</span>), but also through internal momentum (<span class="math inline">\(a_{2,2} C\)</span>), so long as depreciation (<span class="math inline">\(a_{2,3} C\)</span>) and dissipation (<span class="math inline">\(a_{2,4} C^2\)</span>) do not overwhelm it.</p>
<p>The nonlinearity introduced by <span class="math inline">\(-a_{2,4} C^2\)</span> is essential. Unlike traditional diminishing returns, which reduce marginal productivity, this term reflects <strong>conflict internal to the elite class</strong>. In financialized economies where capital is abundant and labor is scarce or irrelevant, competition is not against workers—it is against <strong>other capital holders</strong>. Here, <span class="math inline">\(C^2\)</span> signifies <strong>structural overcrowding</strong> at the top: redundant infrastructure, speculative bubbles, or defensive investments to block new entrants. It is not friction from scarcity; it is friction from saturation.</p>
</section>
<section id="asymptotic-scenarios" class="level2">
<h2 class="anchored" data-anchor-id="asymptotic-scenarios">Asymptotic Scenarios</h2>
<p>This system admits multiple asymptotic regimes depending on the relationship between parameter values:</p>
<p><strong>1. Classical Mutualism (Closed System)</strong><br>
When <span class="math inline">\(a_{2,2} = 0\)</span> and <span class="math inline">\(a_{1,1}, a_{2,1}, a_{1,2}, a_{2,3} &gt; 0\)</span>, the system behaves like a classical Lotka–Volterra cycle:</p>
<ul>
<li><span class="math inline">\(L\)</span> grows when capital is low, declines when capital is high.</li>
<li><span class="math inline">\(C\)</span> grows when labor is abundant, decays otherwise.</li>
<li>Orbits emerge in the phase space, bounded and conservative.</li>
</ul>
<p><strong>Interpretation:</strong> Capital and labor are locked in mutual dependence. Neither can survive alone.</p>
<p><strong>2. Transitional Instability (Automation Activation)</strong><br>
When <span class="math inline">\(a_{2,2} &gt; 0\)</span> but still small relative to <span class="math inline">\(a_{2,1} L\)</span> in most regions, the system begins to destabilize:</p>
<ul>
<li><span class="math inline">\(C\)</span> receives a small automation boost.</li>
<li>If labor weakens slightly, <span class="math inline">\(C\)</span> continues to grow—less dependent on <span class="math inline">\(L\)</span>.</li>
<li>Feedback begins to <strong>tilt asymmetrically</strong> toward capital dominance.</li>
</ul>
<p><strong>Interpretation:</strong> The system is <strong>no longer symmetric</strong>. Capital begins to escape the orbit of labor.</p>
<p><strong>3. Structural Mutation (Irreversibility Activated)</strong><br>
Once <span class="math inline">\(a_{2,2} C \gg a_{2,1} LC\)</span>, capital’s growth is no longer a function of labor.</p>
<p>Conditions for mutation:</p>
<ul>
<li><span class="math inline">\(a_{2,2} &gt; a_{2,3}\)</span>: capital can grow faster than it decays,</li>
<li><span class="math inline">\(a_{1,2} C &gt; a_{1,1}\)</span>: labor is absorbed faster than it reproduces,</li>
<li><span class="math inline">\(a_{2,4} C\)</span> is not too large: elite–elite rivalry remains subcritical.</li>
</ul>
<p>Then:</p>
<ul>
<li><span class="math inline">\(L(t) \to 0\)</span>,<br>
</li>
<li><span class="math inline">\(C(t) \to C^* &gt; 0\)</span> (if friction), or <span class="math inline">\(\to \infty\)</span> (if friction is weak),<br>
</li>
<li><span class="math inline">\((L = 0, C = C^*)\)</span> becomes an <strong>absorbing state</strong>—a terminal attractor.</li>
</ul>
<p><strong>Interpretation:</strong> Labor is not outcompeted—it is made <strong>irrelevant</strong>. Capital sustains itself and eventually <strong>excludes labor</strong> from its dynamic logic.</p>
<p><strong>4. Elite Saturation Collapse</strong><br>
If <span class="math inline">\(a_{2,4}\)</span> becomes too large (e.g., due to capital hoarding, overconcentration, or elite cannibalism):</p>
<ul>
<li>Even autonomous capital growth stalls,</li>
<li><span class="math inline">\(C(t)\)</span> declines after reaching a peak,</li>
<li>System may stabilize at a <strong>low-labor, low-capital</strong> regime—or collapse entirely.</li>
</ul>
<p><strong>Interpretation:</strong> Overaccumulation leads to <strong>implosion</strong>. Not because of labor resistance, but from <strong>excess at the top</strong>.</p>
</section>
<section id="structural-irreversibility-and-phase-space-mutation" class="level2">
<h2 class="anchored" data-anchor-id="structural-irreversibility-and-phase-space-mutation">Structural Irreversibility and Phase Space Mutation</h2>
<p>The transition from a labor–capital mutual system to one governed by autopoietic capital dynamics is not gradual—it is governed by a critical threshold beyond which the system undergoes a <strong>topological mutation</strong>. Prior to this threshold, the system behaves conservatively: labor and capital remain coupled through mutual feedback, and trajectories in the phase space exhibit cyclical or bounded behavior. However, once capital exceeds a structurally determined critical level, the term <span class="math inline">\(a_{2,2}C\)</span> overtakes labor-mediated growth (<span class="math inline">\(a_{2,1}LC\)</span>), shifting the dynamical core from interaction to self-replication. At this point, the system’s structure changes discontinuously: closed orbits vanish, invariant sets collapse toward the capital axis, and the line <span class="math inline">\(L=0\)</span> becomes an <strong>absorbing boundary</strong>. Labor, once displaced, cannot re-enter the system—a condition of <strong>topological irreversibility</strong>. The phase space itself no longer supports recovery pathways. This transformation is not a new equilibrium within the same geometry; it is a qualitative reconfiguration of the geometry itself.</p>
<p>This structural interpretation of automation reveals it as a <strong>mechanism of decoupling</strong>, not simply one of acceleration. It dismantles the co-evolutionary logic of labor and capital, replacing it with an extractive trajectory that systematically erodes labor’s role. As labor vanishes, the site of conflict shifts inward: among capital holders themselves. The nonlinear dissipation term <span class="math inline">\(a_{2,4}C^2\)</span> captures this emergent <strong>elite–elite competition</strong>, where positional advantage and resource saturation determine outcomes. The core asymmetry of the system thus moves from inter-class struggle to <strong>intra-elite positional rivalry</strong>—a transformation concealed in aggregate growth but revealed in structural dynamics.</p>
<p>With this theoretical architecture established, we now turn to the empirical question: does current macroeconomic data exhibit signals of this irreversible transition? In the following section, we estimate the parameters of the system using historical data and identify which regime—closed, transitional, or exclusionary—the contemporary economy occupies within the modeled phase space.</p>
</section>
<section id="estimating-parameters-with-level-data" class="level2">
<h2 class="anchored" data-anchor-id="estimating-parameters-with-level-data">Estimating Parameters with Level Data</h2>
<p>The empirical calibration of structural dynamical models often begins with time series data expressed in <strong>absolute levels</strong>. In the context of labor–capital systems, this typically involves tracking population, capital stock, investment flows, and income components—each representing one component of the theoretical system:</p>
<p><span class="math display">\[
\begin{aligned}
\frac{dL}{dt} &amp;= a_{1,1} L - a_{1,2} L C, \\
\frac{dC}{dt} &amp;= a_{2,1} L C + a_{2,2} C - a_{2,3} C - a_{2,4} C^2.
\end{aligned}
\]</span></p>
<p>Each parameter in this system has a corresponding economic interpretation, often approximated using national account statistics or industry-level indicators:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 14%">
<col style="width: 41%">
<col style="width: 44%">
</colgroup>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Interpretation</th>
<th>Empirical Proxy</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(a_{1,1}\)</span></td>
<td>Endogenous labor growth</td>
<td>Population and participation rates (BLS, UN)</td>
</tr>
<tr class="even">
<td><span class="math inline">\(a_{1,2}\)</span></td>
<td>Capital-induced labor absorption</td>
<td>Wage–productivity divergence, labor share trend</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(a_{2,1}\)</span></td>
<td>Labor-driven capital formation</td>
<td>Profit per worker, reinvestment ratios</td>
</tr>
<tr class="even">
<td><span class="math inline">\(a_{2,2}\)</span></td>
<td>Automation-induced capital growth</td>
<td>Robot density, IT capital share, patent counts</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(a_{2,3}\)</span></td>
<td>Capital depreciation</td>
<td>Consumption of fixed capital (BEA, Eurostat)</td>
</tr>
<tr class="even">
<td><span class="math inline">\(a_{2,4}\)</span></td>
<td>Frictions to capital expansion</td>
<td>Diminishing returns, saturation metrics</td>
</tr>
</tbody>
</table>
<p>While conceptually straightforward, level-based estimation encounters several technical and interpretive challenges. Among these:</p>
<ul>
<li><strong>High sensitivity to measurement errors</strong> in levels, especially when working with small changes (e.g., net investment).</li>
<li><strong>Heterogeneity in units and scaling</strong>, which complicates system-level identification without extensive normalization.</li>
<li><strong>Implicit steady-state assumptions</strong>, particularly when using calibration methods that fix terminal values or target observed ratios (e.g., <span class="math inline">\(C^*/Y^*\)</span> or <span class="math inline">\(K/L\)</span> ratios).</li>
<li><strong>Dependence on aggregation conventions</strong>, such as capital stock estimation or depreciation schedules, which vary significantly across countries and sources.</li>
</ul>
<p>A variety of empirical strategies have been employed in this context:</p>
<ul>
<li><strong>Closed-form identification</strong>: Parameters like <span class="math inline">\(a_{2,3}\)</span> (capital depreciation) can often be directly observed from national accounts.</li>
<li><strong>Time-series regression</strong>: Parameters such as <span class="math inline">\(a_{2,2}\)</span> (automation growth) or <span class="math inline">\(a_{1,2}\)</span> (labor extraction rate) can be estimated by regressing capital growth or labor share decline on automation-related indicators.</li>
<li><strong>Steady-state calibration</strong>: Assuming long-run convergence, one can calibrate parameters to match terminal or average observed values (e.g., setting <span class="math inline">\(a_{2,4}\)</span> to ensure bounded <span class="math inline">\(C\)</span> given observed capital-output ratios).</li>
<li><strong>Bayesian updating</strong>: Priors from the macroeconomic literature (e.g., Solow-type growth parameters) are updated using observed data.</li>
<li><strong>System-level structural estimation</strong>: Full-model techniques such as GMM or maximum likelihood estimation (MLE) are applied to estimate coupled ODEs from observed <span class="math inline">\((L_t, C_t)\)</span> time series.</li>
</ul>
<p>Despite its prevalence, the level-based framework is limited in its ability to track <strong>distributional dynamics</strong> or <strong>relative concentration patterns</strong>, particularly in systems undergoing <strong>structural mutation</strong>. In such cases, absolute levels may grow exponentially while the internal composition of the system changes qualitatively.</p>
<p>To address these limitations, the next section introduces a <strong>share-based estimation strategy</strong> that reinterprets elite capital concentration data as a proxy for system-level capital dominance, enabling estimation of nonlinear dynamics via normalized replicator-like forms. This approach aligns more naturally with inequality-focused modeling, where relative shares and structural saturation matter more than total quantities.</p>
</section>
<section id="estimating-parameters-with-share-data" class="level2">
<h2 class="anchored" data-anchor-id="estimating-parameters-with-share-data">Estimating Parameters with Share Data</h2>
<p>Traditional macroeconomic estimation strategies are typically rooted in level data—aggregate capital stock, total output, labor force levels—used to calibrate dynamic models of production, accumulation, and distribution. While effective in certain contexts, this approach suffers from scaling inconsistencies, comparability issues across time, and sensitivity to nominal shocks. Moreover, level data fails to reveal the <strong>internal stratification</strong> of economic systems—particularly the <strong>distribution of capital</strong> across heterogeneous agents.</p>
<p>To address this, we introduce a share-based approach. Rather than modeling the absolute size of capital or labor, we model their <strong>relative shares</strong>:</p>
<ul>
<li>Capital share: <span class="math inline">\(c(t) = \frac{C(t)}{C(t) + L(t)}\)</span></li>
<li>Labor share: <span class="math inline">\(\ell(t) = 1 - c(t)\)</span></li>
</ul>
<p>This reframing allows us to interpret economic dynamics in terms of <strong>structural positioning</strong> and <strong>relative dominance</strong>, rather than absolute growth. Importantly, this representation is <strong>invariant to total system size</strong>, rendering it more robust for long-term analysis and cross-group comparison.</p>
<section id="u.s.-wealth-share-data-19892024-quarterly" class="level3">
<h3 class="anchored" data-anchor-id="u.s.-wealth-share-data-19892024-quarterly">U.S. Wealth Share Data (1989–2024, Quarterly)</h3>
<p>We utilize quarterly data from the Federal Reserve’s Distributional Financial Accounts (via FRED) to construct empirical capital share trajectories for three elite percentile groups:</p>
<ul>
<li><strong>Top 0.1% Net Wealth Share</strong> (<code>WFRBSTP1300</code>)</li>
<li><strong>Top 1% Net Wealth Share</strong> (<code>WFRBST01134</code>)</li>
<li><strong>Top 10% Net Wealth Share</strong>, computed as the sum of top 1% and 90–99% (<code>WFRBSN09161</code>)</li>
</ul>
<p>These series serve as empirical proxies for the <strong>capital share</strong> <span class="math inline">\(c(t)\)</span> held by each group. Corresponding labor shares are then computed as <span class="math inline">\(\ell(t) = 1 - c(t)\)</span>.</p>
<p>This share-based framing bypasses issues with raw levels (GDP deflators, capital depreciation schedules, labor hours) and instead centers the analysis on <strong>relative control over accumulated wealth</strong>—a key structural feature in capitalist systems.</p>
</section>
<section id="share-based-dynamics" class="level3">
<h3 class="anchored" data-anchor-id="share-based-dynamics">Share-Based Dynamics</h3>
<p>The structural labor–capital model is given in level terms as:</p>
<p><span class="math display">\[
\begin{aligned}
\frac{dL}{dt} &amp;= a_{11} L - a_{12} L C, \\
\frac{dC}{dt} &amp;= a_{21} L C + a_{22} C - a_{23} C - a_{24} C^2.
\end{aligned}
\]</span></p>
<p>Define total system size <span class="math inline">\(S(t) = L(t) + C(t)\)</span> and the <strong>capital share</strong>: <span class="math display">\[
c(t) = \frac{C(t)}{S(t)}.
\]</span></p>
<p>By differentiating this definition with respect to time: <span class="math display">\[
\frac{dc}{dt} = \frac{\dot{C} S - C \dot{S}}{S^2}.
\]</span></p>
<p>Substituting the dynamics: - <span class="math inline">\(\dot{C} = a_{21} L C + a_{22} C - a_{23} C - a_{24} C^2\)</span> - <span class="math inline">\(\dot{L} = a_{11} L - a_{12} L C\)</span> - So <span class="math inline">\(\dot{S} = \dot{L} + \dot{C}\)</span></p>
<p>Now let <span class="math inline">\(C = c S\)</span>, <span class="math inline">\(L = (1 - c) S\)</span> to express everything in terms of <span class="math inline">\(c(t)\)</span> and <span class="math inline">\(S(t)\)</span>.</p>
<p>Assuming <span class="math inline">\(a_{21} \approx 0\)</span> (negligible labor-driven capital growth) and quasi-stationary <span class="math inline">\(S(t)\)</span> over short windows, the expression simplifies to:</p>
<p><span class="math display">\[
\frac{dc}{dt} \approx c (a_{22} - a_{24} c).
\]</span></p>
<p>This <strong>replicator-type equation</strong> captures the nonlinear interplay between:</p>
<ul>
<li><strong>Self-replicating capital</strong> (via <span class="math inline">\(a_{22}\)</span>), and</li>
<li><strong>Intra-elite saturation effects</strong> (via <span class="math inline">\(a_{24}\)</span>).</li>
</ul>
<p>Empirically, this continuous form becomes: <span class="math display">\[
\frac{\Delta c_t}{c_t} \approx a_{22}(t) - a_{24}(t) c_t.
\]</span></p>
<p>By running <strong>rolling-window OLS regressions</strong> (e.g., 20 quarters), we estimate <span class="math inline">\(a_{22}(t)\)</span> and <span class="math inline">\(a_{24}(t)\)</span> as <strong>time-varying structural coefficients</strong>, capturing technological change, financial regime shifts, and institutional transitions.</p>
<p>To estimate the remaining parameters, we turn to the full coupled system. Normalizing the labor-capital system in share terms:</p>
<ul>
<li><p>For labor: <span class="math display">\[
\frac{\Delta \ell_t}{\ell_t} = a_{11}(t) - a_{12}(t) c_t + \varepsilon_t.
\]</span></p></li>
<li><p>For capital (expanded): <span class="math display">\[
\frac{\Delta c_t}{c_t} = a_{21}(t) \ell_t + a_{22}(t) - a_{23}(t) - a_{24}(t) c_t + \varepsilon_t.
\]</span></p></li>
</ul>
<p>Given previously estimated <span class="math inline">\(a_{22}(t)\)</span> and <span class="math inline">\(a_{24}(t)\)</span>, and setting <span class="math inline">\(a_{23}(t) = 0.025\)</span> (fixed quarterly depreciation), we identify:</p>
<ul>
<li><span class="math inline">\(a_{11}(t), a_{12}(t)\)</span>: from labor-share regression,</li>
<li><span class="math inline">\(a_{21}(t)\)</span>: by back-solving from capital equation residuals.</li>
</ul>
</section>
<section id="empirical-findings" class="level3">
<h3 class="anchored" data-anchor-id="empirical-findings">Empirical Findings</h3>
<ol type="1">
<li><strong><span class="math inline">\(a_{22}(t)\)</span></strong> rises sharply during known automation epochs: dot-com boom, smartphone era, and post-2020 AI expansion.</li>
<li><strong><span class="math inline">\(a_{24}(t)\)</span></strong> is consistently positive and increasing with percentile, indicating growing intra-elite competition.</li>
<li><strong><span class="math inline">\(a_{21}(t) \approx 0\)</span> across all groups</strong>, sometimes on the order of <span class="math inline">\(10^{-7}\)</span> or lower.</li>
</ol>
<blockquote class="blockquote">
<p>This implies that capital is <strong>self-reproducing</strong>, with minimal dependence on labor—a hallmark of late-stage automation economies.</p>
</blockquote>
<p>However, setting <span class="math inline">\(a_{21} = 0\)</span> creates degenerate dynamics: over time, both capital and labor vanish. Surprisingly, even capital collapses without minimal labor input.</p>
<p>By setting <span class="math inline">\(a_{21} = 0.0007\)</span> (small but positive), simulations match observed empirical tail behavior in <span class="math inline">\(c(t)\)</span>—showing that even <strong>negligible labor-capital coupling</strong> is structurally vital for long-run viability.</p>
<p>These findings underscore the fragility of modern accumulation systems. The capital-labor system is not sustained by productivity, but by <strong>network-dependent feedback loops</strong>. Small structural parameters—such as <span class="math inline">\(a_{21}\)</span>—govern the <strong>existence of long-run attractors</strong>.</p>
<p>Policy interventions must thus go beyond redistribution. They must alter structural parameters: - Lower <span class="math inline">\(a_{12}\)</span> to reduce labor extraction, - Cap <span class="math inline">\(a_{24}\)</span> to prevent elite overaccumulation, - Increase <span class="math inline">\(a_{21}\)</span> via labor-linked investment, - Shift <span class="math inline">\(a_{22}\)</span> toward inclusive automation.</p>
<p>This model reframes inequality not as an outcome of imbalance, but as a <strong>phase-space feature</strong>—a geometrical consequence of structural dynamics. In summary, share-based empirical modeling reveals structural dependencies invisible in level-data systems. The future of capital depends not on output maximization, but on the topology of feedback and the fragility of replication.</p>
</section>
</section>
<section id="plots" class="level2">
<h2 class="anchored" data-anchor-id="plots">Plots</h2>
<section id="us-wealth-share-data" class="level3">
<h3 class="anchored" data-anchor-id="us-wealth-share-data">US Wealth Share Data</h3>
<div class="cell" data-execution_count="1">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas_datareader.data <span class="im">as</span> web</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.integrate <span class="im">import</span> solve_ivp</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> trim_mean, mode</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the time range</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>start_date <span class="op">=</span> <span class="st">"1989-07-01"</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>end_date <span class="op">=</span> <span class="st">"2024-10-01"</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Download data directly for each group</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> {}</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>data[<span class="st">'Top 0.1%'</span>] <span class="op">=</span> web.DataReader(<span class="st">'WFRBSTP1300'</span>, <span class="st">'fred'</span>, start_date, end_date)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>data[<span class="st">'Top 1%'</span>] <span class="op">=</span> web.DataReader(<span class="st">'WFRBST01134'</span>, <span class="st">'fred'</span>, start_date, end_date)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>data[<span class="st">'Top 90-99%'</span>] <span class="op">=</span> web.DataReader(<span class="st">'WFRBSN09161'</span>, <span class="st">'fred'</span>, start_date, end_date)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine Top 1% and 90-99% to compute Top 10%</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>top_10 <span class="op">=</span> pd.DataFrame(index<span class="op">=</span>data[<span class="st">'Top 1%'</span>].index)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>top_10[<span class="st">'Top 10%'</span>] <span class="op">=</span> data[<span class="st">'Top 1%'</span>][<span class="st">'WFRBST01134'</span>] <span class="op">+</span> data[<span class="st">'Top 90-99%'</span>][<span class="st">'WFRBSN09161'</span>]</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine all into a single DataFrame for analysis</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(index<span class="op">=</span>data[<span class="st">'Top 0.1%'</span>].index)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'Top 0.1%'</span>] <span class="op">=</span> data[<span class="st">'Top 0.1%'</span>][<span class="st">'WFRBSTP1300'</span>]</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'Top 1%'</span>] <span class="op">=</span> data[<span class="st">'Top 1%'</span>][<span class="st">'WFRBST01134'</span>]</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'Top 10%'</span>] <span class="op">=</span> top_10[<span class="st">'Top 10%'</span>]</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.dropna()</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Sample Start: "</span>, start_date)</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Sample End: "</span>, end_date)</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Sample Start:  1989-07-01
Sample End:  2024-10-01</code></pre>
</div>
<div id="tbl-us-data-load" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="1">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-us-data-load-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: Quarterly net wealth share data (Top 0.1%, 1%, and 10%) are retrieved directly from the FRED database and used to compute normalized capital share trajectories over the period 1989Q3 to 2024Q4.
</figcaption>
<div aria-describedby="tbl-us-data-load-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-display" data-execution_count="1">
<div>


<table class="dataframe do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Top 0.1%</th>
<th data-quarto-table-cell-role="th">Top 1%</th>
<th data-quarto-table-cell-role="th">Top 10%</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">DATE</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1989-07-01</td>
<td>8.6</td>
<td>22.9</td>
<td>60.9</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1989-10-01</td>
<td>8.7</td>
<td>23.0</td>
<td>60.9</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1990-01-01</td>
<td>8.6</td>
<td>22.8</td>
<td>60.6</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1990-04-01</td>
<td>8.7</td>
<td>22.9</td>
<td>60.6</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1990-07-01</td>
<td>8.5</td>
<td>22.5</td>
<td>60.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</figure>
</div>
</div>
</section>
<section id="time-varying-parameter-estimates-all-groups" class="level3">
<h3 class="anchored" data-anchor-id="time-varying-parameter-estimates-all-groups">Time-Varying Parameter Estimates (All Groups)</h3>
<div id="ff17c048" class="cell" data-execution_count="2">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Time-varying parameter estimation for each wealth share group, using a rolling window regression on the nonlinear replicator-transformed system. Parameters $a_{2,2}(t)$ and $a_{2,4}(t)$ are inferred from capital share growth, while $a_{1,1}(t)$ and $a_{1,2}(t)$ are extracted from labor share contraction. Residual dynamics yield estimates of $a_{2,1}(t)$ and implied $a_{2,3}(t)$.</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate c(t) and l(t) for each group</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>ct_01 <span class="op">=</span> df[<span class="st">'Top 0.1%'</span>]</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>ct_1 <span class="op">=</span> df[<span class="st">'Top 1%'</span>]</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>ct_10 <span class="op">=</span> df[<span class="st">'Top 10%'</span>]</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>lt_01 <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> ct_01</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>lt_1 <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> ct_1</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>lt_10 <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> ct_10</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Define a function to compute rolling parameter estimates</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> estimate_parameters(c_t, window<span class="op">=</span><span class="dv">20</span>, depreciation<span class="op">=</span><span class="fl">0.025</span>):</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    c_t <span class="op">=</span> c_t.dropna()</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>    l_t <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> c_t</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>    dc <span class="op">=</span> c_t.diff()</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>    dl <span class="op">=</span> l_t.diff()</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>    c_t_lag <span class="op">=</span> c_t.shift(<span class="dv">1</span>)</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>    l_t_lag <span class="op">=</span> l_t.shift(<span class="dv">1</span>)</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>    rel_dc <span class="op">=</span> (dc <span class="op">/</span> c_t_lag).dropna()</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>    rel_dl <span class="op">=</span> (dl <span class="op">/</span> l_t_lag).dropna()</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>    df_rolling <span class="op">=</span> pd.DataFrame({</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>        <span class="st">'c'</span>: c_t_lag,</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>        <span class="st">'l'</span>: l_t_lag,</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>        <span class="st">'dc_rel'</span>: rel_dc,</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>        <span class="st">'dl_rel'</span>: rel_dl</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>    }).dropna()</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>    results <span class="op">=</span> []</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(window, <span class="bu">len</span>(df_rolling)):</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>        window_df <span class="op">=</span> df_rolling.iloc[i <span class="op">-</span> window:i]</span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>        X_c <span class="op">=</span> np.vstack([np.ones(window), <span class="op">-</span>window_df[<span class="st">'c'</span>]]).T</span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>        y_c <span class="op">=</span> window_df[<span class="st">'dc_rel'</span>]</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>        a22, a24 <span class="op">=</span> np.linalg.lstsq(X_c, y_c, rcond<span class="op">=</span><span class="va">None</span>)[<span class="dv">0</span>]</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>        X_l <span class="op">=</span> np.vstack([np.ones(window), <span class="op">-</span>window_df[<span class="st">'c'</span>]]).T</span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>        y_l <span class="op">=</span> window_df[<span class="st">'dl_rel'</span>]</span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>        a11, a12 <span class="op">=</span> np.linalg.lstsq(X_l, y_l, rcond<span class="op">=</span><span class="va">None</span>)[<span class="dv">0</span>]</span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>        a21_minus_a23 <span class="op">=</span> y_c <span class="op">-</span> (a22 <span class="op">-</span> a24 <span class="op">*</span> window_df[<span class="st">'c'</span>])</span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>        X_a21 <span class="op">=</span> window_df[<span class="st">'l'</span>]</span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>        a21 <span class="op">=</span> np.mean(a21_minus_a23 <span class="op">/</span> X_a21)</span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>        a23 <span class="op">=</span> a21 <span class="op">-</span> depreciation  <span class="co"># using assumed depreciation</span></span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>        results.append({</span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>            <span class="st">'date'</span>: df_rolling.index[i],</span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>            <span class="st">'a11'</span>: a11,</span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a>            <span class="st">'a12'</span>: a12,</span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a>            <span class="st">'a21'</span>: a21,</span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a>            <span class="st">'a22'</span>: a22,</span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a>            <span class="st">'a23'</span>: a23,</span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a>            <span class="st">'a24'</span>: a24</span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> pd.DataFrame(results).set_index(<span class="st">'date'</span>)</span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimate for all three groups</span></span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a>res_df_01 <span class="op">=</span> estimate_parameters(ct_01, window<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a>res_df_1 <span class="op">=</span> estimate_parameters(ct_1, window<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a>res_df_10 <span class="op">=</span> estimate_parameters(ct_10, window<span class="op">=</span><span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="cell-fig-rolling-params-all" class="cell" data-execution_count="3">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 추정 대상 그룹</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>group_labels <span class="op">=</span> [<span class="st">'Top 0.1%'</span>, <span class="st">'Top 1%'</span>, <span class="st">'Top 10%'</span>]</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> [res_df_01, res_df_1, res_df_10]</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 파라미터 목록</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>params <span class="op">=</span> [<span class="st">'a11'</span>, <span class="st">'a12'</span>, <span class="st">'a21'</span>, <span class="st">'a22'</span>, <span class="st">'a23'</span>, <span class="st">'a24'</span>]</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">3</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">16</span>, <span class="dv">12</span>), sharex<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>axes <span class="op">=</span> axes.flatten()</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, param <span class="kw">in</span> <span class="bu">enumerate</span>(params):</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> group_df, label <span class="kw">in</span> <span class="bu">zip</span>(results, group_labels):</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> param <span class="kw">in</span> group_df.columns:</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>            axes[i].plot(group_df.index, group_df[param], label<span class="op">=</span>label)</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>    axes[i].set_title(<span class="ss">f"Parameter: </span><span class="sc">{</span>param<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>    axes[i].legend()</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>    axes[i].grid(<span class="va">True</span>)</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-rolling-params-all" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-rolling-params-all-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="d_3_model_files/figure-html/fig-rolling-params-all-output-1.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-rolling-params-all-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Estimated time-varying parameters for each wealth percentile group, based on rolling window regressions. Each panel corresponds to one structural parameter of the labor–capital dynamic system. Differences across percentile groups reflect heterogeneity in structural regimes, such as automation dominance (<span class="math inline">\(a_{2,2}\)</span>) or labor extraction intensity (<span class="math inline">\(a_{1,2}\)</span>).
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="distribution-of-estimated-parameters-histogram" class="level3">
<h3 class="anchored" data-anchor-id="distribution-of-estimated-parameters-histogram">Distribution of Estimated Parameters (Histogram)</h3>
<div id="cell-fig-parameter-histograms" class="cell" data-execution_count="4">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 추정된 모든 파라미터 리스트</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>parameters <span class="op">=</span> [<span class="st">'a11'</span>, <span class="st">'a12'</span>, <span class="st">'a21'</span>, <span class="st">'a22'</span>, <span class="st">'a23'</span>, <span class="st">'a24'</span>]</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>group_dfs <span class="op">=</span> [res_df_01, res_df_1, res_df_10]</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>group_labels <span class="op">=</span> [<span class="st">'Top 0.1%'</span>, <span class="st">'Top 1%'</span>, <span class="st">'Top 10%'</span>]</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>colors <span class="op">=</span> [<span class="st">'tab:blue'</span>, <span class="st">'tab:orange'</span>, <span class="st">'tab:green'</span>]</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">3</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">14</span>, <span class="dv">10</span>))</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>axes <span class="op">=</span> axes.flatten()</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, param <span class="kw">in</span> <span class="bu">enumerate</span>(parameters):</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>    ax <span class="op">=</span> axes[i]</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> df, label, color <span class="kw">in</span> <span class="bu">zip</span>(group_dfs, group_labels, colors):</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>        ax.hist(df[param].dropna(), bins<span class="op">=</span><span class="dv">50</span>, alpha<span class="op">=</span><span class="fl">0.6</span>, label<span class="op">=</span>label, color<span class="op">=</span>color)</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>    ax.set_title(<span class="ss">f"Parameter: </span><span class="sc">{</span>param<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>    ax.set_xlabel(<span class="st">"Value"</span>)</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>    ax.set_ylabel(<span class="st">"Frequency"</span>)</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>    ax.legend()</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>    ax.grid(<span class="va">True</span>)</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-parameter-histograms" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-parameter-histograms-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="d_3_model_files/figure-html/fig-parameter-histograms-output-1.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-parameter-histograms-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Empirical distribution of estimated parameters across Top 0.1%, Top 1%, and Top 10% wealth share groups. Each subplot overlays the histogram of a single parameter’s rolling estimates for all three groups. The visual comparison reveals systematic differences in structural dynamics across percentile tiers.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="parameter-summary-table-group-wise-statistics-by-parameter" class="level2">
<h2 class="anchored" data-anchor-id="parameter-summary-table-group-wise-statistics-by-parameter">Parameter Summary Table: Group-Wise Statistics by Parameter</h2>
<div class="cell" data-execution_count="5">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>depreciation <span class="op">=</span> <span class="fl">0.025</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"depreciation a23 (quarterly): "</span>, depreciation)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> trim_mean, mode</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Define a function to compute descriptive statistics for each parameter</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> summarize_parameters(df, name):</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    summary <span class="op">=</span> pd.DataFrame(index<span class="op">=</span>df.columns)</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>    summary[<span class="st">"median"</span>] <span class="op">=</span> df.median()</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>    summary[<span class="st">"trimmed_mean"</span>] <span class="op">=</span> df.<span class="bu">apply</span>(<span class="kw">lambda</span> x: trim_mean(x.dropna(), <span class="fl">0.1</span>))</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>    summary[<span class="st">"mode"</span>] <span class="op">=</span> df.mode().iloc[<span class="dv">0</span>]</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>    summary[<span class="st">"group"</span>] <span class="op">=</span> name</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> summary</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>summary_01 <span class="op">=</span> summarize_parameters(res_df_01, <span class="st">"Top 0.1%"</span>)</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>summary_1 <span class="op">=</span> summarize_parameters(res_df_1, <span class="st">"Top 1%"</span>)</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>summary_10 <span class="op">=</span> summarize_parameters(res_df_10, <span class="st">"Top 10%"</span>)</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine summaries</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>param_summary <span class="op">=</span> pd.concat([summary_01, summary_1, summary_10])</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>param_summary <span class="op">=</span> param_summary.reset_index().rename(columns<span class="op">=</span>{<span class="st">"index"</span>: <span class="st">"parameter"</span>})</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Overwrite a23 with constant 0.25 (quarterly) for all groups</span></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>param_summary.loc[param_summary[<span class="st">"parameter"</span>] <span class="op">==</span> <span class="st">"a23"</span>, [<span class="st">"median"</span>, <span class="st">"trimmed_mean"</span>, <span class="st">"mode"</span>]] <span class="op">=</span> depreciation</span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract median values as parameter sets</span></span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> extract_params(df, group_name, depreciation<span class="op">=</span><span class="fl">0.025</span>):</span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>    row <span class="op">=</span> df[df[<span class="st">"group"</span>] <span class="op">==</span> group_name].set_index(<span class="st">"parameter"</span>)</span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> {</span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>        <span class="st">"a11"</span>: row.loc[<span class="st">"a11"</span>, <span class="st">"median"</span>],</span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>        <span class="st">"a12"</span>: row.loc[<span class="st">"a12"</span>, <span class="st">"median"</span>],</span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>        <span class="st">"a21"</span>: row.loc[<span class="st">"a21"</span>, <span class="st">"median"</span>],</span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>        <span class="st">"a22"</span>: row.loc[<span class="st">"a22"</span>, <span class="st">"median"</span>],</span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a>        <span class="st">"a23"</span>: depreciation,  <span class="co"># override</span></span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a>        <span class="st">"a24"</span>: row.loc[<span class="st">"a24"</span>, <span class="st">"median"</span>]</span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a>params_top_01 <span class="op">=</span> extract_params(param_summary, <span class="st">"Top 0.1%"</span>)</span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a>params_top_1 <span class="op">=</span> extract_params(param_summary, <span class="st">"Top 1%"</span>)</span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a>params_top_10 <span class="op">=</span> extract_params(param_summary, <span class="st">"Top 10%"</span>)</span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Define representative median parameters (with calibrated a23 = 0.025)</span></span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true" tabindex="-1"></a><span class="co"># 통계량별로 long-form에서 wide-form으로 pivot</span></span>
<span id="cb6-46"><a href="#cb6-46" aria-hidden="true" tabindex="-1"></a>pivot_all <span class="op">=</span> param_summary.pivot_table(</span>
<span id="cb6-47"><a href="#cb6-47" aria-hidden="true" tabindex="-1"></a>    index<span class="op">=</span><span class="st">"parameter"</span>,</span>
<span id="cb6-48"><a href="#cb6-48" aria-hidden="true" tabindex="-1"></a>    columns<span class="op">=</span><span class="st">"group"</span>,</span>
<span id="cb6-49"><a href="#cb6-49" aria-hidden="true" tabindex="-1"></a>    values<span class="op">=</span>[<span class="st">"median"</span>, <span class="st">"trimmed_mean"</span>, <span class="st">"mode"</span>]</span>
<span id="cb6-50"><a href="#cb6-50" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-51"><a href="#cb6-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-52"><a href="#cb6-52" aria-hidden="true" tabindex="-1"></a><span class="co"># 열 순서를 보기 좋게 정렬</span></span>
<span id="cb6-53"><a href="#cb6-53" aria-hidden="true" tabindex="-1"></a>ordered_columns <span class="op">=</span> [</span>
<span id="cb6-54"><a href="#cb6-54" aria-hidden="true" tabindex="-1"></a>    (<span class="st">"median"</span>, <span class="st">"Top 0.1%"</span>), (<span class="st">"median"</span>, <span class="st">"Top 1%"</span>), (<span class="st">"median"</span>, <span class="st">"Top 10%"</span>),</span>
<span id="cb6-55"><a href="#cb6-55" aria-hidden="true" tabindex="-1"></a>    (<span class="st">"trimmed_mean"</span>, <span class="st">"Top 0.1%"</span>), (<span class="st">"trimmed_mean"</span>, <span class="st">"Top 1%"</span>), (<span class="st">"trimmed_mean"</span>, <span class="st">"Top 10%"</span>),</span>
<span id="cb6-56"><a href="#cb6-56" aria-hidden="true" tabindex="-1"></a>    (<span class="st">"mode"</span>, <span class="st">"Top 0.1%"</span>), (<span class="st">"mode"</span>, <span class="st">"Top 1%"</span>), (<span class="st">"mode"</span>, <span class="st">"Top 10%"</span>),</span>
<span id="cb6-57"><a href="#cb6-57" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb6-58"><a href="#cb6-58" aria-hidden="true" tabindex="-1"></a>pivot_all <span class="op">=</span> pivot_all[ordered_columns]</span>
<span id="cb6-59"><a href="#cb6-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-60"><a href="#cb6-60" aria-hidden="true" tabindex="-1"></a><span class="co"># 소수점 자리수 정리</span></span>
<span id="cb6-61"><a href="#cb6-61" aria-hidden="true" tabindex="-1"></a>pivot_all <span class="op">=</span> pivot_all.<span class="bu">round</span>(<span class="dv">5</span>)</span>
<span id="cb6-62"><a href="#cb6-62" aria-hidden="true" tabindex="-1"></a>pivot_all</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>depreciation a23 (quarterly):  0.025</code></pre>
</div>
<div id="tbl-param-summary-wide" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="5">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-param-summary-wide-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;2: Parameter-wise summary statistics across elite groups (Top 0.1%, Top 1%, Top 10%), including median, trimmed mean, and mode for each parameter.
</figcaption>
<div aria-describedby="tbl-param-summary-wide-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-display" data-execution_count="5">
<div>


<table class="dataframe do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th colspan="3" data-quarto-table-cell-role="th" data-halign="left">median</th>
<th colspan="3" data-quarto-table-cell-role="th" data-halign="left">trimmed_mean</th>
<th colspan="3" data-quarto-table-cell-role="th" data-halign="left">mode</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">group</th>
<th data-quarto-table-cell-role="th">Top 0.1%</th>
<th data-quarto-table-cell-role="th">Top 1%</th>
<th data-quarto-table-cell-role="th">Top 10%</th>
<th data-quarto-table-cell-role="th">Top 0.1%</th>
<th data-quarto-table-cell-role="th">Top 1%</th>
<th data-quarto-table-cell-role="th">Top 10%</th>
<th data-quarto-table-cell-role="th">Top 0.1%</th>
<th data-quarto-table-cell-role="th">Top 1%</th>
<th data-quarto-table-cell-role="th">Top 10%</th>
</tr>
<tr class="header">
<th data-quarto-table-cell-role="th">parameter</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">a11</td>
<td>0.12041</td>
<td>0.13333</td>
<td>0.10653</td>
<td>0.11903</td>
<td>0.18327</td>
<td>0.11065</td>
<td>-0.17888</td>
<td>-0.07761</td>
<td>-0.14894</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">a12</td>
<td>0.01050</td>
<td>0.00460</td>
<td>0.00160</td>
<td>0.00995</td>
<td>0.00626</td>
<td>0.00167</td>
<td>-0.01510</td>
<td>-0.00356</td>
<td>-0.00211</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">a21</td>
<td>-0.00000</td>
<td>-0.00000</td>
<td>0.00000</td>
<td>-0.00000</td>
<td>-0.00000</td>
<td>-0.00000</td>
<td>-0.00001</td>
<td>-0.00000</td>
<td>-0.00000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">a22</td>
<td>0.10940</td>
<td>0.12865</td>
<td>0.10479</td>
<td>0.10796</td>
<td>0.17678</td>
<td>0.10894</td>
<td>-0.16071</td>
<td>-0.07477</td>
<td>-0.14669</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">a23</td>
<td>0.02500</td>
<td>0.02500</td>
<td>0.02500</td>
<td>0.02500</td>
<td>0.02500</td>
<td>0.02500</td>
<td>0.02500</td>
<td>0.02500</td>
<td>0.02500</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">a24</td>
<td>0.00950</td>
<td>0.00443</td>
<td>0.00158</td>
<td>0.00902</td>
<td>0.00604</td>
<td>0.00164</td>
<td>-0.01356</td>
<td>-0.00343</td>
<td>-0.00208</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</figure>
</div>
</div>
</section>
<section id="simulated-system-dynamics-with-calibrated-labor-driven-capital-growth-a_21-0.0007" class="level2">
<h2 class="anchored" data-anchor-id="simulated-system-dynamics-with-calibrated-labor-driven-capital-growth-a_21-0.0007">Simulated System Dynamics with Calibrated Labor-Driven Capital Growth (<span class="math inline">\(a_{21} = 0.0007\)</span>)</h2>
<div id="cell-fig-sim-dynamics-shares" class="cell" data-execution_count="6">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.integrate <span class="im">import</span> solve_ivp</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the system of ODEs with fixed a21 = 0.0007</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> simulate_system(params, L0<span class="op">=</span><span class="dv">10</span>, C0<span class="op">=</span><span class="dv">3</span>, t_span<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">140</span>), t_steps<span class="op">=</span><span class="dv">2000</span>):</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> system(t, y):</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>        L, C <span class="op">=</span> y</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>        a11, a12, a21, a22, a23, a24 <span class="op">=</span> (</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>            params[<span class="st">"a11"</span>], params[<span class="st">"a12"</span>], <span class="fl">0.0007</span>,  <span class="co"># fixed!</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>            params[<span class="st">"a22"</span>], params[<span class="st">"a23"</span>], params[<span class="st">"a24"</span>]</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>        dLdt <span class="op">=</span> a11 <span class="op">*</span> L <span class="op">-</span> a12 <span class="op">*</span> L <span class="op">*</span> C</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>        dCdt <span class="op">=</span> a21 <span class="op">*</span> L <span class="op">*</span> C <span class="op">+</span> a22 <span class="op">*</span> C <span class="op">-</span> a23 <span class="op">*</span> C <span class="op">-</span> a24 <span class="op">*</span> C<span class="op">**</span><span class="dv">2</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> [dLdt, dCdt]</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>    t_eval <span class="op">=</span> np.linspace(t_span[<span class="dv">0</span>], t_span[<span class="dv">1</span>], t_steps)</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>    sol <span class="op">=</span> solve_ivp(system, t_span, [L0, C0], t_eval<span class="op">=</span>t_eval)</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sol.t, sol.y[<span class="dv">0</span>], sol.y[<span class="dv">1</span>]</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulations for each group</span></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>t, L_01, C_01 <span class="op">=</span> simulate_system(params_top_01)</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>_, L_1, C_1 <span class="op">=</span> simulate_system(params_top_1)</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>_, L_10, C_10 <span class="op">=</span> simulate_system(params_top_10)</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Normalize to capital share c(t)</span></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>c_01 <span class="op">=</span> C_01 <span class="op">/</span> (L_01 <span class="op">+</span> C_01)</span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>c_1 <span class="op">=</span> C_1 <span class="op">/</span> (L_1 <span class="op">+</span> C_1)</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>c_10 <span class="op">=</span> C_10 <span class="op">/</span> (L_10 <span class="op">+</span> C_10)</span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot: Capital share over time</span></span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">5</span>))</span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>plt.plot(t, c_01, label<span class="op">=</span><span class="st">"Top 0.1%"</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>plt.plot(t, c_1, label<span class="op">=</span><span class="st">"Top 1%"</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>plt.plot(t, c_10, label<span class="op">=</span><span class="st">"Top 10%"</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Simulated Capital Share Dynamics by Group ($a_</span><span class="sc">{21}</span><span class="st"> = 0.0007$)"</span>)</span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Time (Quarters)"</span>)</span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Capital Share $c(t)$"</span>)</span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a>plt.ylim(<span class="dv">0</span>, <span class="fl">1.05</span>)</span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-sim-dynamics-shares" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-sim-dynamics-shares-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="d_3_model_files/figure-html/fig-sim-dynamics-shares-output-1.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-sim-dynamics-shares-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Simulated time-domain capital share dynamics <span class="math inline">\(c(t)\)</span> for each percentile group using calibrated <span class="math inline">\(a_{21} = 0.0007\)</span> and median parameter values.
</figcaption>
</figure>
</div>
</div>
</div>
<div id="cell-fig-phase-space-level" class="cell" data-execution_count="7">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># "Simulated phase trajectories and normalized vector fields in $(L, C)$ space for each percentile group, using calibrated $a_{21} = 0.0007$."</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Define simulation function</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> simulate_system(params, L0<span class="op">=</span><span class="dv">10</span>, C0<span class="op">=</span><span class="dv">3</span>, t_span<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">140</span>), t_steps<span class="op">=</span><span class="dv">2000</span>):</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> system(t, y):</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>        L, C <span class="op">=</span> y</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>        dLdt <span class="op">=</span> params[<span class="st">"a11"</span>] <span class="op">*</span> L <span class="op">-</span> params[<span class="st">"a12"</span>] <span class="op">*</span> L <span class="op">*</span> C</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>        dCdt <span class="op">=</span> <span class="fl">0.0007</span> <span class="op">*</span> L <span class="op">*</span> C <span class="op">+</span> params[<span class="st">"a22"</span>] <span class="op">*</span> C <span class="op">-</span> params[<span class="st">"a23"</span>] <span class="op">*</span> C <span class="op">-</span> params[<span class="st">"a24"</span>] <span class="op">*</span> C<span class="op">**</span><span class="dv">2</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> [dLdt, dCdt]</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>    t_eval <span class="op">=</span> np.linspace(t_span[<span class="dv">0</span>], t_span[<span class="dv">1</span>], t_steps)</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>    sol <span class="op">=</span> solve_ivp(system, t_span, [L0, C0], t_eval<span class="op">=</span>t_eval)</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sol.t, sol.y[<span class="dv">0</span>], sol.y[<span class="dv">1</span>]</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Grid for vector field</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>L_vals <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">150</span>, <span class="dv">150</span>)</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>C_vals <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">150</span>, <span class="dv">150</span>)</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>L_grid, C_grid <span class="op">=</span> np.meshgrid(L_vals, C_vals)</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">3</span>, figsize<span class="op">=</span>(<span class="dv">18</span>, <span class="dv">6</span>))</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>group_params <span class="op">=</span> {</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Top 0.1%"</span>: params_top_01,</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Top 1%"</span>: params_top_1,</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Top 10%"</span>: params_top_10</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> ax, (label, params) <span class="kw">in</span> <span class="bu">zip</span>(axes, group_params.items()):</span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Vector field</span></span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>    a11, a12 <span class="op">=</span> params[<span class="st">"a11"</span>], params[<span class="st">"a12"</span>]</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>    a22, a23, a24 <span class="op">=</span> params[<span class="st">"a22"</span>], params[<span class="st">"a23"</span>], params[<span class="st">"a24"</span>]</span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>    a21 <span class="op">=</span> <span class="fl">0.0007</span>  <span class="co"># fixed</span></span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>    dL <span class="op">=</span> a11 <span class="op">*</span> L_grid <span class="op">-</span> a12 <span class="op">*</span> L_grid <span class="op">*</span> C_grid</span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>    dC <span class="op">=</span> a21 <span class="op">*</span> L_grid <span class="op">*</span> C_grid <span class="op">+</span> a22 <span class="op">*</span> C_grid <span class="op">-</span> a23 <span class="op">*</span> C_grid <span class="op">-</span> a24 <span class="op">*</span> C_grid<span class="op">**</span><span class="dv">2</span></span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>    mag <span class="op">=</span> np.sqrt(dL<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> dC<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>    dL_norm <span class="op">=</span> dL <span class="op">/</span> (mag <span class="op">+</span> <span class="fl">1e-8</span>)</span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>    dC_norm <span class="op">=</span> dC <span class="op">/</span> (mag <span class="op">+</span> <span class="fl">1e-8</span>)</span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a>    ax.quiver(L_grid, C_grid, dL_norm, dC_norm, angles<span class="op">=</span><span class="st">'xy'</span>, color<span class="op">=</span><span class="st">'gray'</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Trajectory</span></span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a>    t, L_sim, C_sim <span class="op">=</span> simulate_system(params)</span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a>    ax.plot(L_sim, C_sim, <span class="st">'r-'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, label<span class="op">=</span><span class="st">'Trajectory'</span>)</span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a>    ax.set_title(<span class="ss">f"Phase Space: </span><span class="sc">{</span>label<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a>    ax.set_xlabel(<span class="st">"Labor (L)"</span>)</span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true" tabindex="-1"></a>    ax.set_ylabel(<span class="st">"Capital (C)"</span>)</span>
<span id="cb9-48"><a href="#cb9-48" aria-hidden="true" tabindex="-1"></a>    ax.set_xlim(<span class="dv">0</span>, <span class="dv">150</span>)</span>
<span id="cb9-49"><a href="#cb9-49" aria-hidden="true" tabindex="-1"></a>    ax.set_ylim(<span class="dv">0</span>, <span class="dv">150</span>)</span>
<span id="cb9-50"><a href="#cb9-50" aria-hidden="true" tabindex="-1"></a>    ax.grid(<span class="va">True</span>)</span>
<span id="cb9-51"><a href="#cb9-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-52"><a href="#cb9-52" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb9-53"><a href="#cb9-53" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-phase-space-level" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-phase-space-level-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="d_3_model_files/figure-html/fig-phase-space-level-output-1.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-phase-space-level-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Level-Based Phase Space with Vector Field and Simulated Trajectories
</figcaption>
</figure>
</div>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>